{
  "version": 3,
  "sources": ["../src/v2.ts", "../src/color.ts", "../src/raster.ts", "../src/graph.ts", "../src/transform2d.ts", "../src/drawables.ts", "../src/viewport.ts", "../src/pixelbuffer.ts", "../src/textCache.ts", "../src/renderer.ts", "../src/tools.ts", "../src/scene.ts", "../src/debugUI.ts", "../src/legend.ts"],
  "sourcesContent": ["// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n// File: src/v2.ts\n// Immutable-API style 2D vector with common ops\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nexport class V2 {\n  constructor(public readonly x: number = 0, public readonly y: number = 0) {}\n\n  clone(): V2 { return new V2(this.x, this.y); }\n\n  add(v: V2): V2 { return new V2(this.x + v.x, this.y + v.y); }\n  sub(v: V2): V2 { return new V2(this.x - v.x, this.y - v.y); }\n  scale(sx: number, sy: number = sx): V2 { return new V2(this.x * sx, this.y * sy); }\n  dot(v: V2): number { return this.x * v.x + this.y * v.y; }\n  perp(): V2 { return new V2(-this.y, this.x); }\n  len(): number { return Math.hypot(this.x, this.y); }\n  norm(): V2 { const l = this.len() || 1; return new V2(this.x / l, this.y / l); }\n\n  /** Rotate around optional pivot. Angle in radians, positive = CCW */\n  rotate(angle: number, around: V2 | null = null): V2 {\n    const c = Math.cos(angle), s = Math.sin(angle);\n    let x = this.x, y = this.y;\n    if (around) { x -= around.x; y -= around.y; }\n    const xr = x * c - y * s;\n    const yr = x * s + y * c;\n    return around ? new V2(xr + around.x, yr + around.y) : new V2(xr, yr);\n  }\n\n  toArray(): [number, number] { return [this.x, this.y]; }\n  static fromArray(a: readonly [number, number]): V2 { return new V2(a[0], a[1]); }\n  static lerp(a: V2, b: V2, t: number): V2 { return new V2(a.x + (b.x - a.x) * t, a.y + (b.y - a.y) * t); }\n}\n", "// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n// File: src/color.ts\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nimport type { RGBA, ColorLike } from \"./types\";\n\n/** Named colors (sRGB) \u2192 RGBA (0..255) */\nexport const NAMED: Readonly<Record<string, RGBA>> = Object.freeze({\n  black: [0, 0, 0, 255], white: [255, 255, 255, 255], red: [255, 0, 0, 255], green: [0, 255, 0, 255],\n  blue: [0, 0, 255, 255], yellow: [255, 255, 0, 255], cyan: [0, 255, 255, 255], magenta: [255, 0, 255, 255],\n  gray: [128, 128, 128, 255], grey: [128, 128, 128, 255], orange: [255, 165, 0, 255],\n  transparent: [0, 0, 0, 0]\n});\n\nexport function clamp255(v: number): number { return v < 0 ? 0 : v > 255 ? 255 : v | 0; }\nexport function clamp01(v: number): number { return v < 0 ? 0 : v > 1 ? 1 : v; }\n\n/** Parse CSS-like colors into [r,g,b,a] (0..255). Returns null if invalid. */\nexport function parseColor(c: ColorLike): RGBA | null {\n  if (Array.isArray(c)) {\n    const [r, g, b, a = 255] = c as number[];\n    return [r | 0, g | 0, b | 0, a | 0];\n  }\n  if (typeof c !== \"string\") return null;\n  const s = c.trim().toLowerCase();\n  if (s in NAMED) return NAMED[s];\n\n  if (s[0] === \"#\") {\n    const hex = s.slice(1);\n    const len = hex.length;\n    const hx = (i: number) => parseInt(hex[i] + (len < 6 ? hex[i] : hex[i + 1] || hex[i]), 16);\n    switch (len) {\n      case 3: return [hx(0), hx(1), hx(2), 255];\n      case 4: return [hx(0), hx(1), hx(2), hx(3)];\n      case 6: return [parseInt(hex.slice(0, 2), 16), parseInt(hex.slice(2, 4), 16), parseInt(hex.slice(4, 6), 16), 255];\n      case 8: return [parseInt(hex.slice(0, 2), 16), parseInt(hex.slice(2, 4), 16), parseInt(hex.slice(4, 6), 16), parseInt(hex.slice(6, 8), 16)];\n      default: return null;\n    }\n  }\n\n  if (s.startsWith(\"rgb\")) {\n    const nums = s.match(/\\d+\\.?\\d*/g);\n    if (!nums || (nums.length !== 3 && nums.length !== 4)) return null;\n    const r = clamp255(+nums[0]);\n    const g = clamp255(+nums[1]);\n    const b = clamp255(+nums[2]);\n    const a = nums[3] == null ? 255 : (clamp01(+nums[3]) * 255 + 0.5) | 0;\n    return [r, g, b, a];\n  }\n  return null;\n}\n\n/** Pack [r,g,b,a] \u2192 ABGR uint32 for fast TypedArray blits (little-endian). */\nexport function packABGR(r: number, g: number, b: number, a: number): number {\n  return (a << 24) | (b << 16) | (g << 8) | r;\n}\n\n/** Unpack ABGR uint32 \u2192 [r,g,b,a] */\nexport function unpackABGR(px: number): RGBA {\n  return [px & 255, (px >>> 8) & 255, (px >>> 16) & 255, (px >>> 24) & 255];\n}\n\n/** Canonical Porter-Duff source-over blend. Inputs are non-premultiplied 0..255. */\nexport function blendRGBA(dr: number, dg: number, db: number, da: number, sr: number, sg: number, sb: number, sa: number): [number, number, number, number] {\n  const dna = da / 255, sna = sa / 255;\n  const outA = sna + dna * (1 - sna);\n  if (outA <= 0) return [0, 0, 0, 0];\n  const inv = 1 - sna;\n  const r = (sr * sna + dr * dna * inv) / outA;\n  const g = (sg * sna + dg * dna * inv) / outA;\n  const b = (sb * sna + db * dna * inv) / outA;\n  return [r, g, b, outA * 255];\n}\n\n/** Normalize any color-like into RGBA (falls back to white). */\nexport function toColor(col: ColorLike): RGBA {\n  if (Array.isArray(col)) {\n    const arr: number[] = col;\n    const rgba: RGBA = [\n      arr[0] | 0,\n      arr[1] | 0,\n      arr[2] | 0,\n      (arr[3] ?? 255) | 0\n    ] as RGBA;\n    return rgba;\n  } else {\n    return (parseColor(col) || NAMED.white) as RGBA;\n  }\n}\n", "\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n// File: src/raster.ts\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nimport { V2 } from \"./v2\";\nimport { toColor, blendRGBA } from \"./color\";\nimport { CanvasRenderer } from \"./renderer\";\n\nexport function rawLine(app: CanvasRenderer, p0: V2, p1: V2, color: Readonly<[number, number, number, number]>): void {\n  const col = color;\n  let x0 = Math.round(p0.x), y0 = Math.round(p0.y);\n  const x1 = Math.round(p1.x), y1 = Math.round(p1.y);\n\n  const dx = Math.abs(x1 - x0), dy = Math.abs(y1 - y0);\n  const sx = x0 < x1 ? 1 : -1, sy = y0 < y1 ? 1 : -1;\n  let err = dx - dy;\n  const buf = app.buffer;\n  while (true) {\n    buf.putPixelBlend(x0, y0, col);\n    if (x0 === x1 && y0 === y1) break;\n    const e2 = err << 1;\n    if (e2 > -dy) { err -= dy; x0 += sx; }\n    if (e2 < dx) { err += dx; y0 += sy; }\n  }\n}\n\nexport interface RawPointOptions { type?: \"circle\" | \"cross\" | \"square\"; size?: number }\n\nexport function rawPoint(app: CanvasRenderer, pos: V2, color: Readonly<[number, number, number, number]>, { type = \"circle\", size = 3 }: RawPointOptions = {}): void {\n  if (type === \"circle\") {\n    fillCircle(app, pos, size, color);\n  } else if (type === \"cross\") {\n    rawLine(app, new V2(pos.x - size, pos.y), new V2(pos.x + size, pos.y), color);\n    rawLine(app, new V2(pos.x, pos.y - size), new V2(pos.x, pos.y + size), color);\n  } else if (type === \"square\") {\n    const half = size | 0;\n    const p = [ new V2(pos.x - half, pos.y - half), new V2(pos.x + half, pos.y - half), new V2(pos.x + half, pos.y + half), new V2(pos.x - half, pos.y + half) ];\n    strokeShape(app, p, color, 1);\n  }\n}\n\nexport function strokeShape(app: CanvasRenderer, points: V2[], color: Readonly<[number, number, number, number]>, width: number = 1): void {\n  for (let i = 0; i < points.length; i++) {\n    const p0 = points[i];\n    const p1 = points[(i + 1) % points.length];\n    if (width <= 1) { rawLine(app, p0, p1, color); continue; }\n    const d = p1.sub(p0); const len = d.len() || 1;\n    const u = d.scale(1 / len);\n    const n = new V2(-u.y, u.x);\n    const half = (width / 2) | 0;\n    for (let o = -half; o <= half; o++) {\n      const off = n.scale(o);\n      rawLine(app, p0.add(off), p1.add(off), color);\n    }\n  }\n}\n\nexport function fillCircle(app: CanvasRenderer, c: V2, r: number, color: Readonly<[number, number, number, number]>): void {\n  const r2 = r * r;\n  const xMin = Math.max(0, Math.floor(c.x) | 0);\n  const xMax = Math.min(app.buffer.width - 1, Math.ceil(c.x) | 0);\n  const yMin = Math.max(0, Math.floor(c.y) | 0);\n  const yMax = Math.min(app.buffer.height - 1, Math.ceil(c.y) | 0);\n  const pix = app.buffer.pixels; const w = app.buffer.width;\n  for (let y = yMin; y <= yMax; y++) {\n    const dy = y - c.y; const dy2 = dy * dy;\n    let idx = ((y * w + xMin) | 0) * 4;\n    for (let x = xMin; x <= xMax; x++, idx += 4) {\n      const dx = x - c.x;\n      if (dx * dx + dy2 <= r2) {\n        const dr = pix[idx], dg = pix[idx + 1], db = pix[idx + 2], da = pix[idx + 3];\n        const [r0, g0, b0, a0] = blendRGBA(dr, dg, db, da, color[0], color[1], color[2], color[3]);\n        pix[idx] = (r0 + 0.5) | 0; pix[idx + 1] = (g0 + 0.5) | 0; pix[idx + 2] = (b0 + 0.5) | 0; pix[idx + 3] = (a0 + 0.5) | 0;\n      }\n    }\n  }\n}\n\n/** Scanline polygon fill (Active Edge Table). `points` in CANVAS space */\nexport function fillPolygon(app: CanvasRenderer, points: V2[], color: Readonly<[number, number, number, number]>): void {\n  const n = points?.length | 0; if (n < 3) return;\n  const h = app.buffer.height | 0, w = app.buffer.width | 0;\n  let minY = Infinity, maxY = -Infinity;\n  const edges: Array<{ ymin: number; ymax: number; x: number; invSlope: number }> = [];\n  for (let i = 0; i < n; i++) {\n    const p1 = points[i], p2 = points[(i + 1) % n];\n    const x1 = p1.x, y1 = p1.y, x2 = p2.x, y2 = p2.y;\n    if (y1 === y2) continue; // skip horizontals\n    const ymin = Math.min(y1, y2), ymax = Math.max(y1, y2);\n    const xAtYmin = y1 < y2 ? x1 : x2;\n    const invSlope = (x2 - x1) / (y2 - y1);\n    edges.push({ ymin, ymax, x: xAtYmin, invSlope });\n    if (ymin < minY) minY = ymin; if (ymax > maxY) maxY = ymax;\n  }\n  minY = Math.max(0, Math.floor(minY) | 0);\n  maxY = Math.min(h - 1, Math.ceil(maxY) | 0);\n\n  const pix = app.buffer.pixels;\n  for (let y = minY; y <= maxY; y++) {\n    const crossings: number[] = [];\n    for (const e of edges) if (y >= e.ymin && y < e.ymax) crossings.push(e.x + (y - e.ymin) * e.invSlope);\n    if (!crossings.length) continue;\n    crossings.sort((a, b) => a - b);\n    for (let k = 0; k < crossings.length; k += 2) {\n      const xStart = Math.max(0, Math.floor(crossings[k]) | 0);\n      const xEnd = Math.min(w - 1, Math.ceil(crossings[k + 1]) | 0);\n      let idx = ((y * w + xStart) | 0) * 4;\n      for (let x = xStart; x <= xEnd; x++, idx += 4) {\n        const dr = pix[idx], dg = pix[idx + 1], db = pix[idx + 2], da = pix[idx + 3];\n        const [r0, g0, b0, a0] = blendRGBA(dr, dg, db, da, color[0], color[1], color[2], color[3]);\n        pix[idx] = (r0 + 0.5) | 0; pix[idx + 1] = (g0 + 0.5) | 0; pix[idx + 2] = (b0 + 0.5) | 0; pix[idx + 3] = (a0 + 0.5) | 0;\n      }\n    }\n  }\n}\n\nexport const drawLine = (app: CanvasRenderer, p0: V2, p1: V2, color: Readonly<[number, number, number, number]>, width: number = 1): void => strokeShape(app, [p0, p1], color, width);\n\nexport function drawCircleOutline(app: CanvasRenderer, c: V2, r: number, color: Readonly<[number, number, number, number]>, width: number = 1, segments: number = 32): void {\n  const pts: V2[] = [];\n  for (let i = 0; i < segments; i++) { const t = (i / segments) * Math.PI * 2; pts.push(new V2(c.x + r * Math.cos(t), c.y + r * Math.sin(t))); }\n  strokeShape(app, pts, color, width);\n}\n", "// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n// File: src/graph.ts\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nimport { V2 } from \"./v2\";\nimport { ViewportManager } from \"./viewport\";\nimport { parseColor } from \"./color\";\nimport type { RGBA } from \"./types\";\nimport { drawLine } from \"./raster\";\n\nfunction decimalsForStep(step: number): number {\n  if (!isFinite(step) || step <= 0) return 0;\n  const s = Math.abs(step);\n  if (s >= 1) return 0;\n  return Math.min(6, Math.ceil(-Math.log10(s)));\n}\n\nfunction fmtTick(x: number, decimals: number): string {\n  const n = +x.toFixed(decimals);\n  const z = Math.abs(n) < 1e-12 ? 0 : n;\n  return z.toFixed(decimals);\n}\n\nexport interface GraphOptions {\n  showGrid?: boolean;\n  showAxes?: boolean;\n  showTicks?: boolean;\n  drawBorder?: boolean;\n  axisAtZero?: boolean;\n  gridColor?: string;\n  axisColor?: string;\n  borderColor?: string;\n  tickSizePx?: number;\n  tickThickness?: number;   \n  axisThickness?: number;   \n  font?: string;            \n  textColor?: string;       \n  margin?: number;\n  labelOffset?: number;    \n  numTicksX?: number;\n  numTicksY?: number;\n}\n\nexport class Graph {\n  public showGrid: boolean;\n  public showAxes: boolean;\n  public showTicks: boolean;\n  public drawBorder: boolean;\n  public axisAtZero: boolean;\n\n  public gridColor: RGBA;\n  public axisColor: RGBA;\n  public borderColor: RGBA;\n\n  public tickSizePx: number;\n  public tickThickness: number;\n  public axisThickness: number;\n  public font: string;\n  public textColor: string;\n  public margin: number;\n  public labelOffset: number;\n\n  public numTicksX: number;\n  public numTicksY: number;\n\n  public axisXPos: number;\n  public axisYPos: number;\n\n  constructor(public vp: ViewportManager, options: GraphOptions = {}) {\n    this.showGrid = options.showGrid !== false;\n    this.showAxes = options.showAxes !== false;\n    this.showTicks = options.showTicks !== false;\n    this.drawBorder = options.drawBorder || false;\n    this.axisAtZero = options.axisAtZero !== false;\n\n    this.gridColor = parseColor(options.gridColor || \"#2a2a2a\")!;\n    this.axisColor = parseColor(options.axisColor || \"#888\")!;\n    this.borderColor = parseColor(options.borderColor || \"#555\")!;\n\n    this.tickSizePx = options.tickSizePx ?? 6;\n    this.tickThickness = options.tickThickness ?? 1;\n    this.axisThickness = options.axisThickness ?? 2;\n    this.font = options.font || \"12px sans-serif\";\n    this.textColor = options.textColor || \"#fff\";\n    this.margin = options.margin ?? 30;\n    this.labelOffset = options.labelOffset ?? 10;\n\n    this.numTicksX = options.numTicksX ?? 5;\n    this.numTicksY = options.numTicksY ?? 5;\n\n    this.axisXPos = 0;\n    this.axisYPos = 0;\n  }\n\n  public setAxisPosition(x: number, y: number) {\n    this.axisXPos = x;\n    this.axisYPos = y;\n  }\n\n  public setLabelStyle(font: string, color: string, offset?: number) {\n    this.font = font;\n    this.textColor = color;\n    if (offset !== undefined) this.labelOffset = offset;\n  }\n\n  private computeTicks(min: number, max: number, n: number): number[] {\n    const range = max - min;\n    if (range === 0) return [min];\n    const stepRaw = range / n;\n    const magnitude = Math.pow(10, Math.floor(Math.log10(stepRaw)));\n    const step = Math.ceil(stepRaw / magnitude) * magnitude;\n\n    const first = Math.ceil(min / step) * step;\n    const ticks: number[] = [];\n    for (let x = first; x <= max; x += step) ticks.push(+x.toFixed(6));\n    return ticks;\n  }\n\n  draw(app: { drawText: (...args: any[]) => void }): void {\n  const vpRect = this.vp.viewport;\n  const world = this.vp.worldBounds;\n  if (!vpRect || !world) return;\n\n\n  const xTicks = this.computeTicks(world.xMin, world.xMax, this.numTicksX);\n  const yTicks = this.computeTicks(world.yMin, world.yMax, this.numTicksY);\n\n  const decimalsX = decimalsForStep(Math.abs(xTicks[1] - xTicks[0] || 1));\n  const decimalsY = decimalsForStep(Math.abs(yTicks[1] - yTicks[0] || 1));\n\n  const drawX = this.axisAtZero && world.yMin <= 0 && world.yMax >= 0 ? this.axisXPos : world.yMin;\n  const drawY = this.axisAtZero && world.xMin <= 0 && world.xMax >= 0 ? this.axisYPos : world.xMin;\n\n\n  if (this.showGrid) {\n\n    for (const x of xTicks) {\n      const p0 = this.vp.worldToCanvas(x, world.yMin);\n      const p1 = this.vp.worldToCanvas(x, world.yMax);\n      drawLine(app as any, p0, p1, this.gridColor, 1);\n    }\n\n    for (const y of yTicks) {\n      const p0 = this.vp.worldToCanvas(world.xMin, y);\n      const p1 = this.vp.worldToCanvas(world.xMax, y);\n      drawLine(app as any, p0, p1, this.gridColor, 1);\n    }\n  }\n\n  if (this.showAxes) {\n    const x0 = this.vp.worldToCanvas(world.xMin, drawX);\n    const x1 = this.vp.worldToCanvas(world.xMax, drawX);\n    const y0 = this.vp.worldToCanvas(drawY, world.yMin);\n    const y1 = this.vp.worldToCanvas(drawY, world.yMax);\n\n    drawLine(app as any, x0, x1, this.axisColor, this.axisThickness);\n    drawLine(app as any, y0, y1, this.axisColor, this.axisThickness);\n  }\n\n\n  if (this.showTicks && this.tickSizePx > 0) {\n    const t = this.tickSizePx;\n\n\n    for (const x of xTicks) {\n      const canvasPos = this.vp.worldToCanvas(x, drawX);\n      drawLine(\n        app as any,\n        new V2(canvasPos.x, canvasPos.y - t / 2),\n        new V2(canvasPos.x, canvasPos.y + t / 2),\n        this.axisColor,\n        this.tickThickness\n      );\n      app.drawText(\n        fmtTick(x, decimalsX),\n        new V2(canvasPos.x, canvasPos.y + this.labelOffset),\n        this.textColor,\n        this.font,\n        \"center\",\n        \"top\"\n      );\n    }\n\n\n    for (const y of yTicks) {\n      const canvasPos = this.vp.worldToCanvas(drawY, y);\n      drawLine(\n        app as any,\n        new V2(canvasPos.x - t / 2, canvasPos.y),\n        new V2(canvasPos.x + t / 2, canvasPos.y),\n        this.axisColor,\n        this.tickThickness\n      );\n      app.drawText(\n        fmtTick(y, decimalsY),\n        new V2(canvasPos.x - this.labelOffset, canvasPos.y),\n        this.textColor,\n        this.font,\n        \"right\",\n        \"middle\"\n      );\n    }\n  }\n}\n}", "// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n// File: src/transform2d.ts\n// 2\u00D73 affine transform compatible with Canvas2D (a b c d e f)\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nimport { V2 } from \"./v2\";\n\n/**\n * 2x3 affine: [ a c e ]\n *             [ b d f ]\n * maps (x,y) -> (a*x + c*y + e, b*x + d*y + f)\n */\nexport class Transform2D {\n  constructor(\n    public a: number = 1, public b: number = 0,\n    public c: number = 0, public d: number = 1,\n    public e: number = 0, public f: number = 0\n  ) {}\n\n  static identity(): Transform2D { return new Transform2D(); }\n  static translation(tx: number, ty: number): Transform2D { return new Transform2D(1, 0, 0, 1, tx, ty); }\n  static scale(sx: number, sy: number = sx): Transform2D { return new Transform2D(sx, 0, 0, sy, 0, 0); }\n  static rotation(angle: number): Transform2D {\n    const c = Math.cos(angle), s = Math.sin(angle);\n    return new Transform2D(c, s, -s, c, 0, 0);\n  }\n  static fromCanvasTransform(a: number, b: number, c: number, d: number, e: number, f: number): Transform2D {\n    return new Transform2D(a, b, c, d, e, f);\n  }\n\n  /** this \u2218 m (apply m first, then this) */\n  multiply(m: Transform2D): Transform2D {\n    return new Transform2D(\n      this.a * m.a + this.c * m.b,\n      this.b * m.a + this.d * m.b,\n      this.a * m.c + this.c * m.d,\n      this.b * m.c + this.d * m.d,\n      this.a * m.e + this.c * m.f + this.e,\n      this.b * m.e + this.d * m.f + this.f\n    );\n  }\n\n  transformV2(v: V2): V2 {\n    return new V2(\n      this.a * v.x + this.c * v.y + this.e,\n      this.b * v.x + this.d * v.y + this.f\n    );\n  }\n\n  /** Build a transform applied around a pivot: T(p) * mat * T(-p) */\n  static around(pivot: V2, mat: Transform2D): Transform2D {\n    return Transform2D.translation(pivot.x, pivot.y).multiply(mat).multiply(Transform2D.translation(-pivot.x, -pivot.y));\n  }\n}\n\n", "// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n// File: src/drawables.ts\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nimport { V2 } from \"./v2\";\nimport { Transform2D } from \"./transform2d\";\nimport {\n  drawLine,\n  fillCircle,\n  drawCircleOutline,\n  fillPolygon,\n  strokeShape,\n  rawPoint,\n} from \"./raster\";\nimport { parseColor } from \"./color\";\nimport { ViewportManager } from \"./viewport\";\n\nexport type LegendSymbol = \"line\" | \"marker\" | \"area\";\n\nexport interface LegendMetadata {\n  label: string;\n  color?: string;\n  symbol?: LegendSymbol;\n}\n\nexport abstract class Drawable {\n\n  public legend?: LegendMetadata;\n\n  constructor(\n    public color: string | readonly [number, number, number, number] = \"white\",\n    public fill: boolean = false,\n    public fillColor: string | readonly [number, number, number, number] | null = null,\n    public transform: Transform2D = Transform2D.identity(),\n    legend?: LegendMetadata\n  ) {\n    if (!this.fillColor) this.fillColor = color;\n    this.legend = legend;\n  }\n\n  /**\n   * Draw the shape.\n   * @param app - rendering backend (canvas wrapper)\n   * @param vp - viewport for coordinate transforms\n   */\n   abstract draw(app: any, vp?: ViewportManager): void;\n\n  protected parseColorSafe(\n    input: string | readonly [number, number, number, number]\n  ): [number, number, number, number] {\n    return [...(parseColor(input) ?? [255, 255, 255, 255])] as [\n      number,\n      number,\n      number,\n      number\n    ];\n  }\n}\n\nexport class DrawableFunction extends Drawable {\n  public baselineY: number;\n\n  constructor(\n    public data: V2[],\n    opts: {\n      color?: string;\n      fill?: boolean;\n      fillColor?: string;\n      baselineY?: number;\n      legend?: LegendMetadata;\n    } = {}\n  ) {\n    super(\n      opts.color ?? \"red\",\n      opts.fill ?? false,\n      opts.fillColor ?? \"rgba(255,0,0,0.3)\",\n      Transform2D.identity(),\n      opts.legend\n    );\n    this.baselineY = opts.baselineY ?? 0;\n  }\n\n  draw(app: any, vp: ViewportManager): void {\n    if (!this.data?.length) return;\n\n    let pPrev = vp.worldToCanvas(this.data[0].x, this.data[0].y);\n    const col = this.parseColorSafe(this.color!);\n\n    for (let i = 1; i < this.data.length; i++) {\n      const pNext = vp.worldToCanvas(this.data[i].x, this.data[i].y);\n      drawLine(app, pPrev, pNext, col);\n      pPrev = pNext;\n    }\n\n    if (!this.fill) return;\n\n    const pts = this.data.map((p) => vp.worldToCanvas(p.x, p.y));\n    const last = this.data[this.data.length - 1];\n    const first = this.data[0];\n    pts.push(vp.worldToCanvas(last.x, this.baselineY));\n    pts.push(vp.worldToCanvas(first.x, this.baselineY));\n    fillPolygon(app, pts, this.parseColorSafe(this.fillColor!));\n  }\n}\n\nexport class DrawableCircle extends Drawable {\n  constructor(\n    public center: V2 = new V2(0, 0),\n    public radius: number = 1,\n    opts: {\n      color?: string;\n      fill?: boolean;\n      fillColor?: string;\n      transform?: Transform2D;\n      legend?: LegendMetadata;\n    } = {}\n  ) {\n    super(\n      opts.color ?? \"white\",\n      opts.fill ?? false,\n      opts.fillColor ?? null,\n      opts.transform ?? Transform2D.identity(),\n      opts.legend\n    );\n  }\n\n  draw(app: any, vp: ViewportManager): void {\n    const cWorld = this.transform.transformV2(this.center);\n    const c = vp.worldToCanvas(cWorld.x, cWorld.y);\n    const sc = vp.scale;\n    const r = this.radius * (vp.preserveAspect ? sc.x : (sc.x + sc.y) * 0.5);\n\n    if (this.fill) fillCircle(app, c, r, this.parseColorSafe(this.fillColor!));\n    drawCircleOutline(app, c, r, this.parseColorSafe(this.color!));\n  }\n}\n\nexport class DrawableLine extends Drawable {\n  public width: number;\n\n  constructor(\n    public p1: V2,\n    public p2: V2,\n    opts: {\n      color?: string;\n      width?: number;\n      transform?: Transform2D;\n      legend?: LegendMetadata;\n    } = {}\n  ) {\n    super(\n      opts.color ?? \"yellow\",\n      false,\n      null,\n      opts.transform ?? Transform2D.identity(),\n      opts.legend\n    );\n    this.width = Math.max(1, (opts.width ?? 2) | 0);\n  }\n\n  draw(app: any, vp: ViewportManager): void {\n    const a = this.transform.transformV2(this.p1);\n    const b = this.transform.transformV2(this.p2);\n    const p0 = vp.worldToCanvas(a.x, a.y);\n    const p1 = vp.worldToCanvas(b.x, b.y);\n    strokeShape(app, [p0, p1], this.parseColorSafe(this.color!), this.width);\n  }\n}\n\nexport class DrawablePoint extends Drawable {\n  public type: \"circle\" | \"cross\" | \"square\";\n  public size: number;\n\n  constructor(\n    public pos: V2,\n    opts: {\n      color?: string;\n      type?: \"circle\" | \"cross\" | \"square\";\n      size?: number;\n      transform?: Transform2D;\n      legend?: LegendMetadata;\n    } = {}\n  ) {\n    super(\n      opts.color ?? \"white\",\n      false,\n      null,\n      opts.transform ?? Transform2D.identity(),\n      opts.legend\n    );\n    this.type = opts.type ?? \"circle\";\n    this.size = opts.size ?? 3;\n  }\n\n  draw(app: any, vp: ViewportManager): void {\n    const pWorld = this.transform.transformV2(this.pos);\n    const c = vp.worldToCanvas(pWorld.x, pWorld.y);\n    rawPoint(app, c, this.parseColorSafe(this.color!), {\n      type: this.type,\n      size: this.size,\n    });\n  }\n}\n\nexport class DrawableTriangle extends Drawable {\n  public points: [V2, V2, V2];\n\n  constructor(\n    p1: V2,\n    p2: V2,\n    p3: V2,\n    opts: {\n      color?: string;\n      fill?: boolean;\n      fillColor?: string;\n      transform?: Transform2D;\n      legend?: LegendMetadata;\n    } = {}\n  ) {\n    super(\n      opts.color ?? \"yellow\",\n      opts.fill ?? true,\n      opts.fillColor ?? \"rgba(255,255,0,0.5)\",\n      opts.transform ?? Transform2D.identity(),\n      opts.legend\n    );\n    this.points = [p1, p2, p3];\n  }\n\n  draw(app: any, vp: ViewportManager): void {\n    const tp = this.points.map((p) => this.transform.transformV2(p));\n    const pts = tp.map((p) => vp.worldToCanvas(p.x, p.y));\n\n    if (this.fill) fillPolygon(app, pts, this.parseColorSafe(this.fillColor!));\n    for (let i = 0; i < 3; i++) {\n      drawLine(app, pts[i], pts[(i + 1) % 3], this.parseColorSafe(this.color!));\n    }\n  }\n}\n\nexport class DrawableText extends Drawable {\n  public font: string;\n  public align: CanvasTextAlign;\n  public baseline: CanvasTextBaseline;\n\n  constructor(\n    public text: string,\n    public pos: V2,\n    opts: {\n      color?: string;\n      font?: string;\n      align?: CanvasTextAlign;\n      baseline?: CanvasTextBaseline;\n      transform?: Transform2D;\n      legend?: LegendMetadata;\n    } = {}\n  ) {\n    super(\n      opts.color ?? \"white\",\n      false,\n      null,\n      opts.transform ?? Transform2D.identity(),\n      opts.legend\n    );\n    this.font = opts.font ?? \"14px sans-serif\";\n    this.align = opts.align ?? \"left\";\n    this.baseline = opts.baseline ?? \"alphabetic\";\n  }\n\n  draw(app: any, vp: ViewportManager): void {\n    const pWorld = this.transform.transformV2(this.pos);\n    const p = vp.worldToCanvas(pWorld.x, pWorld.y);\n    (app as any).drawText(\n      this.text,\n      p,\n      this.color as string,\n      this.font,\n      this.align,\n      this.baseline\n    );\n  }\n}\n\nexport class DrawableLabel extends Drawable {\n  public mode: \"world\" | \"canvas\";\n  public font: string;\n  public align: CanvasTextAlign;\n  public baseline: CanvasTextBaseline;\n\n  constructor(\n    public text: string,\n    public pos: V2,\n    opts: {\n      mode?: \"world\" | \"canvas\";\n      color?: string;\n      font?: string;\n      align?: CanvasTextAlign;\n      baseline?: CanvasTextBaseline;\n      transform?: Transform2D;\n      legend?: LegendMetadata;\n    } = {}\n  ) {\n    super(\n      opts.color ?? \"white\",\n      false,\n      null,\n      opts.transform ?? Transform2D.identity(),\n      opts.legend\n    );\n    this.mode = opts.mode ?? \"world\";\n    this.font = opts.font ?? \"14px sans-serif\";\n    this.align = opts.align ?? \"left\";\n    this.baseline = opts.baseline ?? \"alphabetic\";\n  }\n\n  draw(app: any, vp: ViewportManager): void {\n    const p =\n      this.mode === \"canvas\"\n        ? this.pos\n        : vp.worldToCanvas(\n            this.transform.transformV2(this.pos).x,\n            this.transform.transformV2(this.pos).y\n          );\n    (app as any).drawText(\n      this.text,\n      p,\n      this.color as string,\n      this.font,\n      this.align,\n      this.baseline\n    );\n  }\n}\n", "// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n// File: src/viewport.ts\n// World\u2192canvas mapping \n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nimport { V2 } from \"./v2\";\nimport type { Rect, WorldBounds } from \"./types\";\n\nexport class ViewportManager {\n    public xTicks: number[] = [];\n    public yTicks: number[] = [];\n\n    constructor(\n        public app: { size: V2 },\n        public worldBounds: WorldBounds,\n        private _viewport: Rect | ((app: { size: V2 }) => Rect) = {\n            x: 0,\n            y: 0,\n            width: app.size.x,\n            height: app.size.y,\n        },\n        public preserveAspect: boolean | \"fit\" | \"cover\" | \"none\" = false\n    ) {}\n\n    get viewport(): Rect {\n        return typeof this._viewport === \"function\" ? this._viewport(this.app) : this._viewport;\n    }\n\n    get scale(): V2 {\n        const { xMin, xMax, yMin, yMax } = this.worldBounds;\n        const xRange = xMax - xMin,\n            yRange = yMax - yMin;\n        const vp = this.viewport;\n\n        if (!this.preserveAspect || this.preserveAspect === \"none\") {\n            return new V2(vp.width / xRange, vp.height / yRange);\n        }\n\n        const viewRatio = vp.width / vp.height;\n        const dataRatio = xRange / yRange;\n        const s = viewRatio > dataRatio ? vp.height / yRange : vp.width / xRange;\n        return new V2(s, s);\n    }\n\n    worldToCanvas(x: number, y: number): V2 {\n        const vp = this.viewport;\n        const { xMin, xMax, yMin, yMax } = this.worldBounds;\n        const xRange = xMax - xMin,\n            yRange = yMax - yMin;\n\n        if (this.preserveAspect && this.preserveAspect !== \"none\") {\n            const s = this.scale.x;\n            const scaledWidth = s * xRange,\n                scaledHeight = s * yRange;\n            const offsetX = vp.x + (vp.width - scaledWidth) / 2;\n            const offsetY = vp.y + (vp.height - scaledHeight) / 2;\n            return new V2(offsetX + (x - xMin) * s, offsetY + (yRange - (y - yMin)) * s);\n        } else {\n            const sc = this.scale;\n            return new V2(vp.x + (x - xMin) * sc.x, vp.y + (yMax - y) * sc.y);\n        }\n    }\n\n    canvasToWorld(px: number, py: number): V2 {\n        const vp = this.viewport;\n        const { xMin, xMax, yMin, yMax } = this.worldBounds;\n        const xRange = xMax - xMin,\n            yRange = yMax - yMin;\n\n        if (this.preserveAspect && this.preserveAspect !== \"none\") {\n            const s = this.scale.x;\n            const scaledWidth = s * xRange,\n                scaledHeight = s * yRange;\n            const offsetX = vp.x + (vp.width - scaledWidth) / 2;\n            const offsetY = vp.y + (vp.height - scaledHeight) / 2;\n            return new V2(xMin + (px - offsetX) / s, yMax - (py - offsetY) / s);\n        } else {\n            const sc = this.scale;\n            return new V2(xMin + (px - vp.x) / sc.x, yMax - (py - vp.y) / sc.y);\n        }\n    }\n\n    /** Convert world units to canvas pixels in X (assumes uniform when preserveAspect). */\n    unitsToPixels(units: number): number {\n        return units * this.scale.x;\n    }\n\n    /**\n     * Update world bounds and ticks.\n     * @param bounds \n     * @param numTicks \n     */\n    updateWorld(bounds?: WorldBounds, numTicks: number = 10) {\n        if (bounds) {\n            this.worldBounds = bounds;\n        }\n\n        const { xMin, xMax, yMin, yMax } = this.worldBounds;\n\n        this.xTicks = this.computeTicks(xMin, xMax, numTicks);\n        this.yTicks = this.computeTicks(yMin, yMax, numTicks);\n    }\n\n    private computeTicks(min: number, max: number, numTicks: number): number[] {\n        const range = max - min;\n        if (range <= 0) return [min];\n\n        const step = this.nicify(range / numTicks);\n        const start = Math.ceil(min / step) * step;\n        const ticks: number[] = [];\n        for (let v = start; v <= max; v += step) {\n            ticks.push(+v.toFixed(10)); // clamp fp error\n        }\n        return ticks;\n    }\n\n    private nicify(step: number): number {\n        const exp = Math.floor(Math.log10(step));\n        const base = step / Math.pow(10, exp);\n        let niceBase: number;\n        if (base < 1.5) niceBase = 1;\n        else if (base < 3) niceBase = 2;\n        else if (base < 7) niceBase = 5;\n        else niceBase = 10;\n        return niceBase * Math.pow(10, exp);\n    }\n}\n\nexport function getDivViewport(\n    div: HTMLElement,\n    targetAspect: number = 1,\n    margin: number = 30\n): Rect & { margin: number } {\n    const rect = div.getBoundingClientRect();\n    let width = rect.width,\n        height = rect.height;\n    const currentAspect = width / height;\n    if (currentAspect > targetAspect) width = height * targetAspect;\n    else height = width / targetAspect;\n    return { x: margin, y: margin, width: width - margin * 2, height: height - margin * 2, margin };\n}\n", "\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n// File: src/pixelbuffer.ts\n// A CPU-side pixel buffer backed by ImageData, with blending puts and blits\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nimport { NAMED, parseColor, packABGR, blendRGBA } from \"./color\";\n\nexport class PixelBuffer {\n  public width = 0;\n  public height = 0;\n  public imageData: ImageData;\n  public pixels: Uint8ClampedArray; // RGBA view\n  public px32: Uint32Array;         // ABGR packed view\n\n  constructor(width: number, height: number) {\n    this.imageData = new ImageData(Math.max(1, width | 0), Math.max(1, height | 0));\n    this.pixels = this.imageData.data;\n    this.px32 = new Uint32Array(this.pixels.buffer);\n    this.width = this.imageData.width;\n    this.height = this.imageData.height;\n  }\n\n  resize(width: number, height: number): void {\n    this.imageData = new ImageData(Math.max(1, width | 0), Math.max(1, height | 0));\n    this.pixels = this.imageData.data;\n    this.px32 = new Uint32Array(this.pixels.buffer);\n    this.width = this.imageData.width;\n    this.height = this.imageData.height;\n  }\n\n  clear(color: string = \"#131313\"): void {\n    const c = parseColor(color) || NAMED.black;\n    const packed = packABGR(c[0], c[1], c[2], c[3]);\n    this.px32.fill(packed);\n  }\n\n  private index(x: number, y: number): number { return ((y * this.width + x) | 0) * 4; }\n\n  putPixel(x: number, y: number, color: Readonly<[number, number, number, number]>): void {\n    if (x >>> 0 >= this.width >>> 0 || y >>> 0 >= this.height >>> 0) return;\n    const i = this.index(x | 0, y | 0);\n    const c = color;\n    this.pixels[i] = c[0]; this.pixels[i + 1] = c[1]; this.pixels[i + 2] = c[2]; this.pixels[i + 3] = c[3];\n  }\n\n  putPixelBlend(x: number, y: number, color: Readonly<[number, number, number, number]>): void {\n    if (x >>> 0 >= this.width >>> 0 || y >>> 0 >= this.height >>> 0) return;\n    const i = this.index(x | 0, y | 0);\n    const dr = this.pixels[i], dg = this.pixels[i + 1], db = this.pixels[i + 2], da = this.pixels[i + 3];\n    const [r, g, b, a] = blendRGBA(dr, dg, db, da, color[0], color[1], color[2], color[3]);\n    this.pixels[i] = (r + 0.5) | 0; this.pixels[i + 1] = (g + 0.5) | 0; this.pixels[i + 2] = (b + 0.5) | 0; this.pixels[i + 3] = (a + 0.5) | 0;\n  }\n\n  /** Alpha-blit ImageData into this buffer at (dx,dy). */\n  blit(srcImageData: ImageData, dx: number, dy: number): void {\n    const sw = srcImageData.width | 0, sh = srcImageData.height | 0;\n    const src = srcImageData.data;\n    const w = this.width, h = this.height;\n    dx |= 0; dy |= 0;\n\n    const startX = Math.max(0, dx);\n    const startY = Math.max(0, dy);\n    const endX = Math.min(w, dx + sw);\n    const endY = Math.min(h, dy + sh);\n\n    for (let sy = startY - dy; sy < endY - dy; sy++) {\n      const ty = dy + sy;\n      const rowOff = ty * w;\n      for (let sx = startX - dx; sx < endX - dx; sx++) {\n        const tx = dx + sx;\n        const sIdx = (sy * sw + sx) * 4;\n        const dIdx = (rowOff + tx) * 4;\n\n        const dr = this.pixels[dIdx], dg = this.pixels[dIdx + 1], db = this.pixels[dIdx + 2], da = this.pixels[dIdx + 3];\n        const sr = src[sIdx], sg = src[sIdx + 1], sb = src[sIdx + 2], sa = src[sIdx + 3];\n        const alpha = sa / 255;\n        const invAlpha = 1 - alpha;\n\n        this.pixels[dIdx]     = (sr * alpha + dr * invAlpha + 0.5) | 0;\n        this.pixels[dIdx + 1] = (sg * alpha + dg * invAlpha + 0.5) | 0;\n        this.pixels[dIdx + 2] = (sb * alpha + db * invAlpha + 0.5) | 0;\n        this.pixels[dIdx + 3] = (sa * alpha + da * invAlpha + 0.5) | 0;\n      }\n    }\n  }\n}\n\n", "\n\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n// File: src/textCache.ts\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nexport class TextCache {\n    private map = new Map<string, ImageData>();\n    constructor(public capacity: number = 256) { this.capacity |= 0; }\n\n    get(key: string): ImageData | null {\n        const v = this.map.get(key);\n        if (v) { this.map.delete(key); this.map.set(key, v); }\n        return v ?? null;\n    }\n\n    set(key: string, value: ImageData): void {\n        if (this.map.has(key)) this.map.delete(key);\n        this.map.set(key, value);\n        while (this.map.size > this.capacity) {\n            const firstKey = this.map.keys().next().value;\n            if (firstKey !== undefined) {\n                this.map.delete(firstKey);\n            }\n        }\n    }\n\n    clear(): void { this.map.clear(); }\n}\n", "// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n// File: src/renderer.ts\n// DOM canvas \u2190\u2192 PixelBuffer bridge\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nimport { V2 } from \"./v2\";\nimport { PixelBuffer } from \"./pixelbuffer\";\nimport { TextCache } from \"./textCache\";\n\nexport class CanvasRenderer {\n  public ctx: CanvasRenderingContext2D;\n  public size: V2;\n  public buffer: PixelBuffer;\n  private textCanvas: HTMLCanvasElement;\n  private textCtx: CanvasRenderingContext2D;\n  private textCache: TextCache;\n  private resizeCallbacks: Array<() => void> = [];\n  public renderables: Array<{ draw: (app: CanvasRenderer) => void }> = [];\n\n  constructor(public canvas: HTMLCanvasElement = document.querySelector(\"canvas\")!) {\n    this.ctx = canvas.getContext(\"2d\")!;\n    this.size = new V2(canvas.width, canvas.height);\n    this.buffer = new PixelBuffer(this.size.x, this.size.y);\n\n    this.textCanvas = document.createElement(\"canvas\");\n    this.textCtx = this.textCanvas.getContext(\"2d\")!;\n    this.textCache = new TextCache(512);\n\n    window.addEventListener(\"resize\", () => this.onResize());\n  }\n\n  private resizeCanvas(): void { this.canvas.width = this.size.x; this.canvas.height = this.size.y; }\n\n  private onResize(): void {\n    this.size = new V2(window.innerWidth | 0, window.innerHeight | 0);\n    this.resizeCanvas();\n    this.buffer.resize(this.size.x, this.size.y);\n    this.renderAll();\n    this.resizeCallbacks.forEach(cb => cb());\n  }\n\n  onResizeCallback(cb: () => void): void { this.resizeCallbacks.push(cb); }\n  addRenderable(obj: { draw: (app: CanvasRenderer) => void }): void { this.renderables.push(obj); }\n\n  clear(color: string = \"#131313\"): void { this.buffer.clear(color); }\n\n  putPixel(p: V2, color: Readonly<[number, number, number, number]>): void { this.buffer.putPixel(p.x | 0, p.y | 0, color); }\n  putPixelBlend(p: V2, color: Readonly<[number, number, number, number]>): void { this.buffer.putPixelBlend(p.x | 0, p.y | 0, color); }\n  blitImageData(img: ImageData, dx: number, dy: number): void { this.buffer.blit(img, dx, dy); }\n\n  render(): void { this.ctx.putImageData(this.buffer.imageData, 0, 0); }\n\n  renderAll(): void { this.clear(); this.renderables.forEach(obj => obj.draw(this)); this.render(); }\n\n  /** Draw text via cached raster. Options support align/baseline like Canvas2D. */\n  drawText(text: string, pos: V2, color: string = \"#fff\", font: string = \"12px sans-serif\", align: CanvasTextAlign = \"left\", baseline: CanvasTextBaseline = \"alphabetic\"): void {\n    const key = `${text}|${font}|${color}`;\n    let entry = this.textCache.get(key);\n    if (!entry) {\n      const ctx = this.textCtx;\n      ctx.font = font;\n      const metrics = ctx.measureText(text);\n      const w = Math.ceil(metrics.width + 4);\n      const h = Math.ceil((metrics.actualBoundingBoxAscent || 10) + (metrics.actualBoundingBoxDescent || 4) + 4);\n      if (this.textCanvas.width < w || this.textCanvas.height < h) {\n        this.textCanvas.width = w; this.textCanvas.height = h;\n      }\n      ctx.clearRect(0, 0, w, h);\n      ctx.font = font; ctx.fillStyle = color; ctx.textBaseline = \"top\"; ctx.textAlign = \"left\";\n      ctx.fillText(text, 2, 2);\n      entry = ctx.getImageData(0, 0, w, h);\n      this.textCache.set(key, entry);\n    }\n\n    const { width: tw, height: th } = entry;\n    let ox = 0, oy = 0;\n    switch (align) { case \"center\": ox = -tw / 2; break; case \"right\": case \"end\": ox = -tw; break; }\n    switch (baseline) {\n      case \"top\": oy = 0; break;\n      case \"middle\": oy = -th / 2; break;\n      case \"bottom\": case \"ideographic\": oy = -th; break;\n      case \"alphabetic\": oy = -th; break;\n    }\n\n\n    this.blitImageData(entry, (pos.x + ox + 0.5) | 0, (pos.y + oy + 0.5) | 0);\n  }\n}\n\nexport class DynamicCanvasRenderer {\n  public app: CanvasRenderer;\n  constructor(public containerDiv: HTMLElement, options: { background?: string } = {}) {\n    const canvas = document.createElement(\"canvas\");\n    containerDiv.appendChild(canvas);\n    Object.assign(canvas.style, { width: \"100%\", height: \"100%\", display: \"block\", background: options.background || \"black\" });\n    this.app = new CanvasRenderer(canvas);\n    window.addEventListener(\"resize\", () => this.resize());\n    this.resize();\n  }\n\n  resize(): void {\n    const rect = this.containerDiv.getBoundingClientRect();\n    const w = Math.max(1, rect.width | 0), h = Math.max(1, rect.height | 0);\n    const canvas = this.app.canvas;\n    canvas.width = w; canvas.height = h;\n    this.app.size = new V2(w, h);\n    this.app.buffer.resize(w, h);\n  }\n\n  clear(): void { this.app.clear(); }\n  render(): void { this.app.render(); }\n}\n\n", "\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n// File: src/tools.ts\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nimport { V2 } from \"./v2\";\nimport { Transform2D } from \"./transform2d\";\nimport { fillCircle } from \"./raster\";\nimport { parseColor, NAMED } from \"./color\";\nimport { ViewportManager } from \"./viewport\";\n\nexport function rotatePoint(p: V2, center: V2, angle: number): V2 { return p.rotate(angle, center); }\n\nexport function rotateTriangleAroundCenter(tri: { points: V2[] }, center: V2, angle: number): void {\n  tri.points = tri.points.map(p => rotatePoint(p, center, angle));\n}\n\nexport function rotateTriangleVertical(tri: { points: V2[] }, center: V2, angle: number): void {\n  const m = Transform2D.around(center, Transform2D.scale(Math.cos(angle), 1));\n  tri.points = tri.points.map(p => m.transformV2(p));\n}\n\n/** 2.5D projection: keep Y, scale X by cos(angle) about `center`. */\nexport function projectYRotation(point: V2, center: V2, angle: number): V2 {\n  const m = Transform2D.around(center, Transform2D.scale(Math.cos(angle), 1));\n  return m.transformV2(point);\n}\n\nexport class Intercepts {\n  static findX(series: V2[]): number[] {\n    const out: number[] = [];\n    for (let i = 1; i < series.length; i++) {\n      const y1 = series[i - 1].y, y2 = series[i].y;\n      if (y1 === 0) out.push(series[i - 1].x);\n      else if (y1 * y2 < 0) { const x1 = series[i - 1].x, x2 = series[i].x; out.push(x1 + (-y1 / (y2 - y1)) * (x2 - x1)); }\n    }\n    return out;\n  }\n  static drawX(app: any, vp: ViewportManager, series: V2[], color = \"yellow\") {\n    const col = parseColor(color) || NAMED.yellow;\n    const xs = Intercepts.findX(series);\n    for (const x of xs) {\n      const p = vp.worldToCanvas(x, 0);\n      fillCircle(app, new V2((p.x + 0.5) | 0, (p.y + 0.5) | 0), 5, col);\n    }\n  }\n\n}\n", "// src/scene.ts\nimport { Drawable } from \"./drawables\";\nimport { ViewportManager } from \"./viewport\";\nimport { CanvasRenderer } from \"./renderer\";\nimport { LegendItem } from \"./legend\";\n\ninterface Layer {\n    name: string;\n    drawables: Drawable[];\n}\n\nexport class Scene {\n    private layers: Layer[] = [];\n\n    add(items: Drawable[] | Drawable, layerName: string = \"default\"): this {\n        const drawables = Array.isArray(items) ? items : [items];\n        let layer = this.layers.find(l => l.name === layerName);\n\n        if (!layer) {\n            layer = { name: layerName, drawables: [] };\n            this.layers.push(layer);\n            this.sortLayers();\n        }\n\n        layer.drawables.push(...drawables);\n        return this;\n    }\n\n\n    remove(item: Drawable): this {\n        for (const layer of this.layers) {\n            layer.drawables = layer.drawables.filter(d => d !== item);\n        }\n        return this;\n    }\n\n    clear(layerName?: string): this {\n        if (layerName) {\n            const layer = this.layers.find(l => l.name === layerName);\n            if (layer) layer.drawables.length = 0;\n        } else {\n            this.layers.length = 0;\n        }\n        return this;\n    }\n\n\n    draw(app: CanvasRenderer, vp: ViewportManager): void {\n\n        for (const layer of this.layers) {\n            if (layer.name === \"debug\") continue;\n            for (const d of layer.drawables) {\n                if ((d as any).visible === false) continue;\n                d.draw(app, vp);\n            }\n        }\n\n\n        const debugLayer = this.layers.find(l => l.name === \"debug\");\n        if (debugLayer) {\n            for (const d of debugLayer.drawables) {\n                if ((d as any).visible === false) continue;\n\n                if ((d as any).ignoreViewport) {\n                    d.draw(app, undefined);\n                } else {\n                    d.draw(app, vp);\n                }\n            }\n        }\n    }\n\n    collectLegend(): LegendItem[] {\n        const items: LegendItem[] = [];\n        for (const layer of this.layers) {\n            for (const d of layer.drawables) {\n                const meta = (d as any).legend;\n                if (meta) {\n                    items.push({\n                        label: meta.label,\n                        color: meta.color ?? (d as any).color ?? \"#fff\",\n                        symbol: meta.symbol ?? \"line\",\n                    });\n                }\n            }\n        }\n        return items;\n    }\n\n    private sortLayers() {\n        this.layers.sort((a, b) => {\n            if (a.name === \"debug\") return 1;\n            if (b.name === \"debug\") return -1;\n            return a.name.localeCompare(b.name);\n        });\n    }\n}\n", "// src/DebugUI.ts\nimport { Drawable } from \"./drawables\";\nimport { CanvasRenderer } from \"./renderer\";\nimport { V2 } from \"./v2\";\n\nclass UILabel {\n    constructor(\n        public text: string,\n        public pos: V2,\n        public color: string = \"#fff\",\n        public font: string = \"16px monospace\"\n    ) { }\n\n    draw(renderer: CanvasRenderer, margin: number = 2) {\n        const safePos = new V2(this.pos.x + margin, this.pos.y + margin);\n        renderer.drawText(this.text, safePos, this.color, this.font, \"left\", \"top\");\n    }\n}\n\nexport class DebugUI extends Drawable {\n    public elements: UILabel[] = [];\n    private lastTime: number = performance.now();\n    public visible: boolean = true;\n    public ignoreViewport = true; // important\n    private static registry: DebugUI[] = [];\n    private readonly margin: number;\n\n    constructor(pos: V2 = new V2(10, 10), margin: number = 2) {\n        super(\"white\", false, null);\n        this.margin = margin;\n        const fps = new UILabel(\"FPS: 0\", pos);\n        this.elements.push(fps);\n\n        DebugUI.registry.push(this);\n    }\n\n    update() {\n        const now = performance.now();\n        const dt = now - this.lastTime;\n        const fps = dt > 0 ? Math.round(1000 / dt) : 0;\n        this.elements[0].text = `FPS: ${fps}`;\n        this.lastTime = now;\n    }\n\n    draw(app: CanvasRenderer) {\n        if (!this.visible) return;\n        for (const el of this.elements) {\n            el.draw(app, this.margin);\n        }\n    }\n\n    static updateAll() {\n        for (const ui of DebugUI.registry) ui.update();\n    }\n}\n", "// src/legend.ts\nimport { V2 } from \"./v2\";\nimport { ViewportManager } from \"./viewport\";\nimport { fillCircle, drawLine, fillPolygon } from \"./raster\";\nimport { parseColor } from \"./color\";\nimport { Drawable } from \"./drawables\";\n\nexport type LegendSymbol = \"line\" | \"marker\" | \"area\";\nexport interface LegendItem {\n  label: string;\n  color: string;\n  symbol?: LegendSymbol;\n}\n\nexport interface LegendOptions {\n  anchor?: \"ne\" | \"nw\" | \"se\" | \"sw\";\n  padding?: number;\n  gap?: number;\n  swatchSize?: number;\n  font?: string;\n  textColor?: string;\n  background?: string | null;\n  boxOffset?: V2;\n  maxWidthPx?: number;\n}\n\nexport class DrawableLegend extends Drawable {\n  constructor(\n    public items: LegendItem[],\n    public options: LegendOptions = {}\n  ) {\n    super(\"white\", false, null);\n  }\n\n  private estimateTextWidth(label: string, font: string): number {\n    const m = /(\\d+)\\s*px/.exec(font);\n    const px = m ? parseInt(m[1], 10) : 12;\n    return Math.max(8, Math.round(label.length * px * 0.6));\n  }\n\n  draw(app: any, vp: ViewportManager): void {\n    const opts: Required<LegendOptions> = {\n      anchor: this.options.anchor ?? \"ne\",\n      padding: this.options.padding ?? 8,\n      gap: this.options.gap ?? 6,\n      swatchSize: this.options.swatchSize ?? 14,\n      font: this.options.font ?? \"12px sans-serif\",\n      textColor: this.options.textColor ?? \"#fff\",\n      background: (this.options.background === undefined ? \"rgba(0,0,0,0.35)\" : this.options.background) as any,\n      boxOffset: this.options.boxOffset ?? new V2(0, 0),\n      maxWidthPx: this.options.maxWidthPx ?? 0\n    };\n\n    if (!this.items?.length) return;\n\n    const vpRect = vp.viewport;\n    const pad = opts.padding;\n    const sw = opts.swatchSize;\n    const rowH = Math.max(sw, 12) + opts.gap;\n\n    let textW = 0;\n    for (const it of this.items) {\n      textW = Math.max(textW, this.estimateTextWidth(it.label, opts.font));\n    }\n    const contentW = sw + 6 + textW;\n    const boxW = (opts.maxWidthPx && opts.maxWidthPx > contentW ? opts.maxWidthPx : contentW) + pad * 2;\n    const boxH = this.items.length * rowH - opts.gap + pad * 2;\n\n    let x = 0, y = 0;\n    switch (opts.anchor) {\n      case \"ne\":\n        x = vpRect.x + vpRect.width - boxW - 4; y = vpRect.y + 4; break;\n      case \"nw\":\n        x = vpRect.x + 4; y = vpRect.y + 4; break;\n      case \"se\":\n        x = vpRect.x + vpRect.width - boxW - 4; y = vpRect.y + vpRect.height - boxH - 4; break;\n      case \"sw\":\n        x = vpRect.x + 4; y = vpRect.y + vpRect.height - boxH - 4; break;\n    }\n    x += opts.boxOffset.x; y += opts.boxOffset.y;\n\n    if (opts.background) {\n      const bg = parseColor(opts.background) || [0,0,0,128];\n      const r: [V2,V2,V2,V2] = [\n        new V2(x, y),\n        new V2(x + boxW, y),\n        new V2(x + boxW, y + boxH),\n        new V2(x, y + boxH),\n      ];\n      fillPolygon(app, r, bg as any);\n    }\n\n    let cx = x + pad;\n    let cy = y + pad + rowH / 2;\n\n    for (const it of this.items) {\n      const col = parseColor(it.color) || [255,255,255,255];\n      const sym = it.symbol ?? \"line\";\n\n      if (sym === \"marker\") {\n        fillCircle(app, new V2(Math.round(cx + sw/2), Math.round(cy)), Math.max(3, Math.floor(sw/3)), col as any);\n      } else if (sym === \"area\") {\n        const r: [V2,V2,V2,V2] = [\n          new V2(cx, cy - sw/2 + 3),\n          new V2(cx + sw, cy - sw/2 + 3),\n          new V2(cx + sw, cy + sw/2 - 3),\n          new V2(cx, cy + sw/2 - 3),\n        ];\n        fillPolygon(app, r, col as any);\n        drawLine(app, new V2(cx, cy - sw/2), new V2(cx + sw, cy - sw/2), col as any, 1);\n      } else {\n        drawLine(app, new V2(cx, cy), new V2(cx + sw, cy), col as any, 2);\n      }\n\n      app.drawText(it.label, new V2(cx + sw + 6, cy), opts.textColor, opts.font, \"left\", \"middle\");\n      cy += rowH;\n    }\n  }\n}\n"],
  "mappings": "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",
  "names": ["V2", "_V2", "x", "y", "v", "sx", "sy", "l", "angle", "around", "c", "s", "xr", "yr", "a", "b", "t", "NAMED", "clamp255", "v", "clamp01", "parseColor", "c", "r", "g", "b", "a", "s", "hex", "len", "hx", "i", "nums", "packABGR", "unpackABGR", "px", "blendRGBA", "dr", "dg", "db", "da", "sr", "sg", "sb", "sa", "dna", "sna", "outA", "inv", "toColor", "col", "arr", "rawLine", "app", "p0", "p1", "color", "col", "x0", "y0", "x1", "y1", "dx", "dy", "sx", "sy", "err", "buf", "e2", "rawPoint", "pos", "type", "size", "fillCircle", "V2", "half", "p", "strokeShape", "points", "width", "i", "d", "len", "u", "n", "o", "off", "c", "r", "r2", "xMin", "xMax", "yMin", "yMax", "pix", "w", "y", "dy2", "idx", "dr", "dg", "db", "da", "r0", "g0", "b0", "a0", "blendRGBA", "fillPolygon", "h", "minY", "maxY", "edges", "p2", "x2", "y2", "ymin", "ymax", "xAtYmin", "invSlope", "crossings", "e", "a", "k", "xStart", "xEnd", "x", "drawLine", "drawCircleOutline", "segments", "pts", "t", "decimalsForStep", "step", "s", "fmtTick", "x", "decimals", "n", "Graph", "vp", "options", "parseColor", "y", "font", "color", "offset", "min", "max", "range", "stepRaw", "magnitude", "first", "ticks", "app", "vpRect", "world", "xTicks", "yTicks", "decimalsX", "decimalsY", "drawX", "drawY", "p0", "p1", "drawLine", "x0", "x1", "y0", "y1", "t", "canvasPos", "V2", "Transform2D", "_Transform2D", "a", "b", "c", "d", "e", "f", "tx", "ty", "sx", "sy", "angle", "s", "m", "v", "V2", "pivot", "mat", "Drawable", "color", "fill", "fillColor", "transform", "Transform2D", "legend", "input", "parseColor", "DrawableFunction", "data", "opts", "app", "vp", "pPrev", "col", "i", "pNext", "drawLine", "pts", "p", "last", "first", "fillPolygon", "DrawableCircle", "center", "V2", "radius", "cWorld", "c", "sc", "r", "fillCircle", "drawCircleOutline", "DrawableLine", "p1", "p2", "a", "b", "p0", "strokeShape", "DrawablePoint", "pos", "pWorld", "rawPoint", "DrawableTriangle", "p3", "DrawableText", "text", "DrawableLabel", "ViewportManager", "app", "worldBounds", "_viewport", "preserveAspect", "xMin", "xMax", "yMin", "yMax", "xRange", "yRange", "vp", "V2", "viewRatio", "dataRatio", "s", "x", "y", "scaledWidth", "scaledHeight", "offsetX", "offsetY", "sc", "px", "py", "units", "bounds", "numTicks", "min", "max", "range", "step", "start", "ticks", "v", "exp", "base", "niceBase", "getDivViewport", "div", "targetAspect", "margin", "rect", "width", "height", "PixelBuffer", "width", "height", "color", "c", "parseColor", "NAMED", "packed", "packABGR", "x", "y", "i", "dr", "dg", "db", "da", "r", "g", "b", "a", "blendRGBA", "srcImageData", "dx", "dy", "sw", "sh", "src", "w", "h", "startX", "startY", "endX", "endY", "sy", "rowOff", "sx", "tx", "sIdx", "dIdx", "sr", "sg", "sb", "sa", "alpha", "invAlpha", "TextCache", "capacity", "key", "v", "value", "firstKey", "CanvasRenderer", "canvas", "V2", "PixelBuffer", "TextCache", "cb", "obj", "color", "p", "img", "dx", "dy", "text", "pos", "font", "align", "baseline", "key", "entry", "ctx", "metrics", "w", "h", "tw", "th", "ox", "oy", "DynamicCanvasRenderer", "containerDiv", "options", "rect", "rotatePoint", "p", "center", "angle", "rotateTriangleAroundCenter", "tri", "rotateTriangleVertical", "m", "Transform2D", "projectYRotation", "point", "Intercepts", "_Intercepts", "series", "out", "i", "y1", "y2", "x1", "x2", "app", "vp", "color", "col", "parseColor", "NAMED", "xs", "x", "fillCircle", "V2", "Scene", "items", "layerName", "drawables", "layer", "l", "item", "d", "app", "vp", "debugLayer", "meta", "a", "b", "UILabel", "text", "pos", "color", "font", "renderer", "margin", "safePos", "V2", "DebugUI", "_DebugUI", "Drawable", "fps", "now", "dt", "app", "el", "ui", "DrawableLegend", "Drawable", "items", "options", "label", "font", "m", "px", "app", "vp", "opts", "V2", "vpRect", "pad", "sw", "rowH", "textW", "it", "contentW", "boxW", "boxH", "x", "y", "bg", "parseColor", "r", "fillPolygon", "cx", "cy", "col", "sym", "fillCircle", "drawLine"]
}
